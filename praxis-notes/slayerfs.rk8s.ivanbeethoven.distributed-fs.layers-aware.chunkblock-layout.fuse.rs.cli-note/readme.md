[src/gh]: https://github.com/rk8s-dev/rk8s.git "(~ . @main/project/slayerfs) ::: (Apache-2.0) /// SlayerFS // æ€æ‰‹æ–‡ä»¶ç³»ç»Ÿ /// High-performance Rust & Layers-aware Distributed Filesystem // é«˜æ€§èƒ½ Rust å’Œæ”¯æŒåˆ†å±‚çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ /// âœ¨ Project Overview // âœ¨ é¡¹ç›®æ¦‚è§ˆ /// SlayerFS is a Rust-based distributed filesystem for container and AI scenarios. It uses a chunk/block layout and integrates with object storage backends (LocalFS implemented; S3/Rustfs reserved) to provide path-based read/write, directory operations, truncate, and other basic capabilities, making it easy to integrate with SDKs and FUSE. // SlayerFS æ˜¯ä¸€ä¸ªåŸºäº Rust çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œé€‚ç”¨äºå®¹å™¨å’Œ AI åº”ç”¨åœºæ™¯ã€‚å®ƒé‡‡ç”¨å—/åˆ†å—å¸ƒå±€ï¼Œå¹¶é›†æˆäº†å¯¹è±¡å­˜å‚¨åç«¯ï¼ˆå·²å®ç° LocalFSï¼›S3/Rustfs ä¿ç•™ï¼‰ï¼Œæä¾›åŸºäºè·¯å¾„çš„è¯»/å†™ã€ç›®å½•æ“ä½œã€æˆªæ–­ç­‰åŸºæœ¬åŠŸèƒ½ï¼Œä½¿å…¶æ˜“äºä¸ SDK å’Œ FUSE é›†æˆã€‚ /// Core idea: decouple compute from storage. Applications use POSIX-like interfaces to access data, while the scheduler/cache layers decide where the data lives and how itâ€™s accessed. // æ ¸å¿ƒæ€æƒ³ï¼šå°†è®¡ç®—ä¸å­˜å‚¨è§£è€¦ã€‚åº”ç”¨ç¨‹åºä½¿ç”¨ç±»ä¼¼ POSIX çš„æ¥å£è®¿é—®æ•°æ®ï¼Œè€Œè°ƒåº¦å™¨/ç¼“å­˜å±‚åˆ™å†³å®šæ•°æ®å­˜å‚¨åœ¨å“ªé‡Œä»¥åŠå¦‚ä½•è®¿é—®æ•°æ®ã€‚ /// Components overview: // ç»„ä»¶æ¦‚è§ˆï¼š /// - chuck: ChunkLayout, ChunkReader/Writer. Maps file offsets to chunk/block and handles cross-block IO and zero-filling holes. // chuckï¼šChunkLayoutã€ChunkReader/Writerã€‚å°†æ–‡ä»¶åç§»é‡æ˜ å°„åˆ°å—/å—ï¼Œå¹¶å¤„ç†è·¨å— I/O å’Œé›¶å¡«å……ç©ºæ´ã€‚ /// - cadapter: Object backend abstraction and implementations (LocalFs implemented; S3/Rustfs placeholders). // cadapterï¼šå¯¹è±¡åç«¯æŠ½è±¡å’Œå®ç°ï¼ˆå·²å®ç° LocalFsï¼›S3/Rustfs å ä½ç¬¦ï¼‰ã€‚ /// - meta: In-memory metadata + transactions (InMemoryMetaStore). Tracks size and slice, supports commit/rollback. // å…ƒæ•°æ®ï¼šå†…å­˜å…ƒæ•°æ® + äº‹åŠ¡ï¼ˆInMemoryMetaStoreï¼‰ã€‚è·Ÿè¸ªå¤§å°å’Œåˆ‡ç‰‡ï¼Œæ”¯æŒæäº¤/å›æ»šã€‚ /// - vfs: Path-based simplified VFS (mkdir_p/create/read/write/readdir/stat/unlink/rmdir/rename/truncate). // vfsï¼šåŸºäºè·¯å¾„çš„ç®€åŒ– VFSï¼ˆmkdir_p/åˆ›å»º/è¯»å–/å†™å…¥/è¯»å–ç›®å½•/ç»Ÿè®¡/å–æ¶ˆé“¾æ¥/åˆ é™¤ç›®å½•/é‡å‘½å/æˆªæ–­ï¼‰ã€‚ /// - sdk: App-facing lightweight client wrapper (with LocalClient convenience). // sdkï¼šé¢å‘åº”ç”¨ç¨‹åºçš„è½»é‡çº§å®¢æˆ·ç«¯å°è£…å™¨ï¼ˆå…·æœ‰ LocalClient ä¾¿åˆ©æ€§ï¼‰ã€‚ /// ğŸŒŸ Current Features (MVP) // ğŸŒŸ å½“å‰åŠŸèƒ½ï¼ˆMVPï¼‰ /// Path-based VFS // åŸºäºè·¯å¾„çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ /// - mkdir_p/create/read/write/readdir/stat/exists/unlink/rmdir/rename/truncate // mkdir_p/åˆ›å»º/è¯»å–/å†™å…¥/è¯»å–ç›®å½•/ç»Ÿè®¡/æ˜¾ç¤º/å–æ¶ˆé“¾æ¥/åˆ é™¤ç›®å½•/é‡å‘½å/æˆªæ–­ /// - Single mutex to protect the namespace (avoid multi-lock deadlocks); avoid awaiting under lock on hot paths // ä½¿ç”¨å•ä¸ªäº’æ–¥é”ä¿æŠ¤å‘½åç©ºé—´ï¼ˆé¿å…å¤šé‡é”æ­»é”ï¼‰ï¼›é¿å…åœ¨çƒ­è·¯å¾„ä¸Šç­‰å¾…é”å®šçŠ¶æ€ /// Chunked IO with zero-fill // é›¶å¡«å……çš„åˆ†å— I/O /// - 64MiB chunk + 4MiB block (default, configurable) // 64MiB æ•°æ®å— + 4MiB æ•°æ®å—ï¼ˆé»˜è®¤ï¼Œå¯é…ç½®ï¼‰ /// - Write path splits by block; read path returns zeros for holes // å†™å…¥è·¯å¾„æŒ‰å—åˆ†å‰²ï¼›è¯»å–è·¯å¾„åœ¨ç©ºä½å¤„è¿”å›é›¶ã€‚ /// Object-backed BlockStore // åŸºäºå¯¹è±¡çš„å—å­˜å‚¨ /// - LocalFs implemented (for tests/examples); S3/Rustfs placeholders // LocalFs å·²å®ç°ï¼ˆç”¨äºæµ‹è¯•/ç¤ºä¾‹ï¼‰ï¼›S3/Rustfs å ä½ç¬¦ /// Metadata with txn // åŒ…å« txn çš„å…ƒæ•°æ® /// - InMemoryMetaStore: alloc_inode, record_slice, update_size (truncate shrink works) // InMemoryMetaStoreï¼šalloc_inodeã€record_sliceã€update_sizeï¼ˆæˆªæ–­æ”¶ç¼©æœ‰æ•ˆï¼‰ /// - Transaction commit/rollback tests are in place // äº‹åŠ¡æäº¤/å›æ»šæµ‹è¯•å·²å°±ç»ª /// More: see doc/sdk.md and inline rustdoc. // æ›´å¤šä¿¡æ¯ï¼šè¯·å‚é˜… doc/sdk.md å’Œå†…è” rustdocã€‚"
[old.src/gh]: https://github.com/Ivanbeethoven/slayerfs.git "(Apache-2.0) (Languages: Rust 100%) SlayerFS: é«˜æ€§èƒ½ Rust & FUSE-based S3 å®¹å™¨æ–‡ä»¶ç³»ç»Ÿ /// æœ¬é¡¹ç›®ç»´æŠ¤äº RK8S /// ä½œä¸º RK8S ç”Ÿæ€çš„æ ¸å¿ƒå­˜å‚¨å­é¡¹ç›®ï¼ŒSlayerFS è‡´åŠ›äºåœ¨å®¹å™¨ç¯å¢ƒä¸­æä¾›é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„å¯¹è±¡å­˜å‚¨æ–‡ä»¶ç³»ç»ŸæŠ½è±¡ã€‚ /// âœ¨ é¡¹ç›®ç®€ä»‹ /// SlayerFS æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„AI&å®¹å™¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨ç›´æ¥æ›¿ä»£å®¹å™¨çš„ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨åº•å±‚å®ç°æ™ºèƒ½çš„æ–‡ä»¶å­˜å‚¨è°ƒåº¦å’Œç®¡ç†ã€‚é€šè¿‡ FUSE æŠ€æœ¯å°† S3 å…¼å®¹å¯¹è±¡æˆ–å…¶ä»–å­˜å‚¨é€æ˜åœ°æŒ‚è½½ä¸ºå®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿæˆ–æ•°æ®å±‚ï¼Œå½»åº•æ”¹å˜å®¹å™¨çš„æ•°æ®è®¿é—®æ¨¡å¼ã€‚ /// æ ¸å¿ƒç†å¿µï¼šè®©å®¹å™¨æ— éœ€æ„ŸçŸ¥åº•å±‚å­˜å‚¨ä½ç½®ï¼Œé€šè¿‡ SlayerFS çš„è°ƒåº¦å±‚è‡ªåŠ¨å†³å®šæ•°æ®çš„å­˜å‚¨ä½ç½®ï¼ˆæœ¬åœ°ç¼“å­˜ã€è¿œç¨‹ S3ï¼‰å’Œè®¿é—®ç­–ç•¥ï¼Œå®ç°çœŸæ­£çš„å­˜ç®—åˆ†ç¦»å’Œå¼¹æ€§æ‰©å±•ã€‚ /// SlayerFS ä½¿ç”¨ Rust æ„å»ºï¼Œå……åˆ†åˆ©ç”¨äº† Rust çš„å†…å­˜å®‰å…¨ç‰¹æ€§å’Œé«˜æ€§èƒ½å¹¶å‘èƒ½åŠ›ï¼Œè®©å®¹å™¨èƒ½å¤Ÿä»¥æ ‡å‡† POSIX æ–‡ä»¶æ“ä½œæ–¹å¼æ— ç¼è®¿é—®åˆ†å¸ƒå¼å­˜å‚¨èµ„æºã€‚ /// ğŸŒŸ æ ¸å¿ƒç‰¹æ€§ /// ï¿½ å®¹å™¨æ–‡ä»¶ç³»ç»Ÿæ›¿ä»£ /// - é€æ˜æ›¿æ¢ï¼šå®Œå…¨æ›¿ä»£å®¹å™¨çš„ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œåº”ç”¨æ— éœ€ä¿®æ”¹ /// - æ™ºèƒ½è°ƒåº¦ï¼šåº•å±‚è‡ªåŠ¨å†³å®šæ–‡ä»¶çš„å­˜å‚¨ä½ç½®å’Œè®¿é—®ç­–ç•¥ï¼Œå®ç°ä¸å…¶ä»–å­˜å‚¨å’Œé•œåƒæ–‡ä»¶çš„æ— ç¼è¡”æ¥ /// - å­˜ç®—åˆ†ç¦»ï¼šè®¡ç®—å’Œå­˜å‚¨å®Œå…¨è§£è€¦ï¼Œæ”¯æŒæ— çŠ¶æ€å®¹å™¨ /// - å¼¹æ€§æ‰©å±•ï¼šå­˜å‚¨å®¹é‡å’Œæ€§èƒ½å¯ç‹¬ç«‹æ‰©å±• /// ğŸ§  æ™ºèƒ½å­˜å‚¨è°ƒåº¦ /// - å¤šå±‚å­˜å‚¨ï¼šæœ¬åœ° MEM/SSD ç¼“å­˜ + è¿œç¨‹ S3 å­˜å‚¨çš„åˆ†å±‚æ¶æ„ /// - çƒ­æ•°æ®è¯†åˆ«ï¼šåŸºäºè®¿é—®æ¨¡å¼æ™ºèƒ½è¯†åˆ«çƒ­ç‚¹æ•°æ® /// - é¢„æµ‹æ€§é¢„å–ï¼šAI é©±åŠ¨çš„æ•°æ®é¢„å–ç­–ç•¥ /// - åŠ¨æ€è¿ç§»ï¼šæ•°æ®åœ¨ä¸åŒå­˜å‚¨å±‚é—´çš„è‡ªåŠ¨è¿ç§» /// ğŸš€ é«˜æ€§èƒ½ç¼“å­˜ç³»ç»Ÿ /// - å¤šå±‚ç¼“å­˜æ¶æ„ï¼šå†…å­˜ç¼“å­˜ + ç£ç›˜ç¼“å­˜ + è¿œç¨‹å­˜å‚¨ /// - æ™ºèƒ½é¢„å–ï¼šåŸºäºè®¿é—®æ¨¡å¼çš„æ•°æ®é¢„å–ç­–ç•¥ /// - å¹¶å‘ä¼˜åŒ–ï¼šå¼‚æ­¥ I/O å’Œå¤šçº¿ç¨‹ä¼˜åŒ– /// - ç¼“å­˜ä¸€è‡´æ€§ï¼šå¯é…ç½®çš„ç¼“å­˜å¤±æ•ˆç­–ç•¥ /// ğŸ§© å®¹å™¨ç”Ÿæ€æ·±åº¦é›†æˆ /// - æ ¹æ–‡ä»¶ç³»ç»Ÿæ›¿æ¢ï¼šå¯ä½œä¸ºå®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿ /// - overlayfs å…¼å®¹ï¼šå®Œç¾æ”¯æŒå®¹å™¨çš„åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ /// - CSI é©±åŠ¨ï¼šæ”¯æŒ Kubernetes CSI æ¥å£ /// - å®¹å™¨è¿è¡Œæ—¶é›†æˆï¼šä¸ Dockerã€containerdã€CRI-O æ— ç¼é›†æˆ /// ğŸ› ï¸ ä¼ä¸šçº§ç‰¹æ€§ /// - ç›‘æ§é›†æˆï¼šPrometheus metrics æ”¯æŒ /// - æ—¥å¿—ç³»ç»Ÿï¼šç»“æ„åŒ–æ—¥å¿—å’Œé“¾è·¯è¿½è¸ª /// - æ•…éšœæ¢å¤ï¼šè‡ªåŠ¨é‡è¿å’Œé”™è¯¯å¤„ç† /// - é…ç½®ç®¡ç†ï¼šYAML/TOML é…ç½®æ–‡ä»¶æ”¯æŒ /// ğŸ¯ ä½¿ç”¨åœºæ™¯ /// ï¿½ å®¹å™¨æ–‡ä»¶ç³»ç»Ÿç°ä»£åŒ– /// - æ— çŠ¶æ€å®¹å™¨ï¼šå½»åº•æ¶ˆé™¤å®¹å™¨å¯¹æœ¬åœ°å­˜å‚¨çš„ä¾èµ– /// - ç§’çº§å¯åŠ¨ï¼šå®¹å™¨å¯åŠ¨æ—¶æ— éœ€ä¸‹è½½å®Œæ•´é•œåƒæ•°æ® /// - å­˜å‚¨å¼¹æ€§ï¼šå­˜å‚¨å®¹é‡å¯ç‹¬ç«‹äºè®¡ç®—èµ„æºè¿›è¡Œæ‰©å±• /// - å¤šå‰¯æœ¬å…±äº«ï¼šå¤šä¸ªå®¹å™¨å®ä¾‹å…±äº«ç›¸åŒçš„æ•°æ®é›† /// ï¿½ğŸ“Š AI/ML å·¥ä½œè´Ÿè½½ä¼˜åŒ– /// - æ¨¡å‹å³æœåŠ¡ï¼šå°†è®­ç»ƒå¥½çš„æ¨¡å‹ä½œä¸ºæ–‡ä»¶ç³»ç»Ÿç›´æ¥æŒ‚è½½ /// - æ•°æ®é›†è™šæ‹ŸåŒ–ï¼šTB çº§æ•°æ®é›†çš„é€æ˜è®¿é—®ï¼Œæ— éœ€æœ¬åœ°å­˜å‚¨ /// - è®­ç»ƒåŠ é€Ÿï¼šçƒ­æ•°æ®è‡ªåŠ¨ç¼“å­˜åˆ°é«˜é€Ÿ SSD /// - æ¨¡å‹ç‰ˆæœ¬ç®¡ç†ï¼šä¸åŒç‰ˆæœ¬æ¨¡å‹çš„å¿«é€Ÿåˆ‡æ¢ /// ğŸ­ å¾®æœåŠ¡æ¶æ„å‡çº§ /// - é…ç½®ä¸­å¿ƒåŒ–ï¼šåº”ç”¨é…ç½®æ–‡ä»¶ç»Ÿä¸€å­˜å‚¨åœ¨ S3 /// - ä¾èµ–åŒ…ç®¡ç†ï¼šè¿è¡Œæ—¶ä¾èµ–çš„åŠ¨æ€åŠ è½½ /// - æ—¥å¿—å½’æ¡£ï¼šåº”ç”¨æ—¥å¿—è‡ªåŠ¨å½’æ¡£åˆ°å¯¹è±¡å­˜å‚¨ /// - é™æ€èµ„æºï¼šWeb åº”ç”¨é™æ€èµ„æºçš„é€æ˜è®¿é—® /// ğŸ—ƒï¸ æ•°æ®æ¹–ä¸å¤§æ•°æ® /// - æ•°æ®æ¹–ç›´è¿ï¼šå¤§æ•°æ®åº”ç”¨ç›´æ¥è®¿é—®æ•°æ®æ¹– /// - ETL ä½œä¸šä¼˜åŒ–ï¼šæ‰¹å¤„ç†ä½œä¸šçš„è¾“å…¥è¾“å‡ºä¼˜åŒ– /// - å†å²æ•°æ®è®¿é—®ï¼šå½’æ¡£æ•°æ®çš„é€æ˜è®¿é—® /// - å¤šç§Ÿæˆ·éš”ç¦»ï¼šåŸºäºè·¯å¾„çš„å¤šç§Ÿæˆ·æ•°æ®éš”ç¦» /// â˜ï¸ è¾¹ç¼˜è®¡ç®—åœºæ™¯ /// - è¾¹ç¼˜ç¼“å­˜ï¼šè¾¹ç¼˜èŠ‚ç‚¹çš„æ™ºèƒ½æ•°æ®ç¼“å­˜ /// - ä¸­å¿ƒåŒ–å­˜å‚¨ï¼šè¾¹ç¼˜è®¡ç®—ç»“æœçš„ä¸­å¿ƒåŒ–å­˜å‚¨ /// - å¸¦å®½ä¼˜åŒ–ï¼šæ ¹æ®ç½‘ç»œçŠ¶å†µæ™ºèƒ½è°ƒåº¦æ•°æ®ä¼ è¾“ /// - ç¦»çº¿èƒ½åŠ›ï¼šç½‘ç»œä¸­æ–­æ—¶çš„æœ¬åœ°ç¼“å­˜è®¿é—®"
[docs/dev]: https://rk8s.dev/docs/slayerfs ""
[intro.llm/deepwiki]: https://deepwiki.com/rk8s-dev/rk8s/4-slayerfs-distributed-filesystem "Purpose and Scope // ç›®çš„å’ŒèŒƒå›´ /// SlayerFS is a high-performance, layers-aware distributed filesystem implemented in Rust. It provides a POSIX-compatible filesystem interface with pluggable metadata and block storage backends, enabling flexible deployment across different infrastructure environments. This document covers the architecture, components, and integration points of SlayerFS. // SlayerFS æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€æ”¯æŒåˆ†å±‚çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨ Rust è¯­è¨€å®ç°ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå…¼å®¹ POSIX çš„æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œå¹¶æ”¯æŒå¯æ’æ‹”çš„å…ƒæ•°æ®å’Œå—å­˜å‚¨åç«¯ï¼Œä»è€Œèƒ½å¤Ÿçµæ´»åœ°éƒ¨ç½²åœ¨ä¸åŒçš„åŸºç¡€æ¶æ„ç¯å¢ƒä¸­ã€‚æœ¬æ–‡æ¡£å°†ä»‹ç» SlayerFS çš„æ¶æ„ã€ç»„ä»¶å’Œé›†æˆç‚¹ã€‚ /// SlayerFS employs a three-tier architecture that cleanly separates concerns: // SlayerFS é‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼Œæ¸…æ™°åœ°åˆ†ç¦»äº†å„ä¸ªå…³æ³¨ç‚¹ï¼š /// - VFS Layer: Provides path-based file operations and exposes both FUSE and SDK interfaces // VFS å±‚ ï¼šæä¾›åŸºäºè·¯å¾„çš„æ–‡ä»¶æ“ä½œï¼Œå¹¶å…¬å¼€ FUSE å’Œ SDK æ¥å£ã€‚ /// - Metadata Layer: Manages filesystem metadata (inodes, directory structure, attributes) with pluggable backend implementations // å…ƒæ•°æ®å±‚ ï¼šç®¡ç†æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ï¼ˆinodesã€ç›®å½•ç»“æ„ã€å±æ€§ï¼‰ï¼Œå¹¶æä¾›å¯æ’æ‹”çš„åç«¯å®ç°ã€‚ /// - Block Storage Layer: Handles chunk-based data storage with support for S3 and local filesystem backends // å—å­˜å‚¨å±‚ ï¼šå¤„ç†åŸºäºå—çš„æ•°æ®å­˜å‚¨ï¼Œæ”¯æŒ S3 å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿåç«¯ã€‚ /// - This separation enables independent scaling and optimization of metadata and data operations, similar to distributed filesystems like JuiceFS and Ceph. // è¿™ç§åˆ†ç¦»ä½¿å¾—å…ƒæ•°æ®å’Œæ•°æ®æ“ä½œèƒ½å¤Ÿç‹¬ç«‹æ‰©å±•å’Œä¼˜åŒ–ï¼Œç±»ä¼¼äº JuiceFS å’Œ Ceph ç­‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚"

