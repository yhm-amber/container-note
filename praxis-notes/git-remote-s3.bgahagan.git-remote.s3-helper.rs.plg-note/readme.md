[src/gh]: https://github.com/bgahagan/git-remote-s3.git "(MIT) (Languages: Rust 86.9%, Shell 13.1%) Push and pull git repos to/from an s3 bucket, encrypted using gpg. // 使用 gpg 加密，将 git 仓库推送到 s3 存储桶或从 s3 存储桶拉取 git 仓库。 /// Git Remote S3 Helper // Git 远程 S3 助手 /// Push and pull git repos to/from an s3 bucket. Uses gpg to encrypt the repo contents (but not branch names!) before sending to s3. // 将 Git 仓库推送到 S3 存储桶或从 S3 存储桶拉取 Git 仓库。使用 GPG 对仓库内容（但不包括分支名称！）进行加密，然后再发送到 S3。 /// This likely most useful for small teams who don't want to host their own private repository, but still want to manage their own encryption. For example, my use case is periodically backing up a repo from a desktop and pull to a laptop to develop remotely. // 这对于不想托管私有代码库但又想管理加密的小型团队来说可能最为实用。例如，我的使用场景是定期从台式机备份代码库，然后拉取到笔记本电脑进行远程开发。 /// Example Usage // 用法示例 /// (: git remote add -- s3remote s3://<your_bucket>/prefix # Add a remote using the s3 transport // 使用 s3 传输添加远程) (: git pull s3remote master ;: git push s3remote) (: git clone s3://<your_bucket>/prefix # even clone from s3) /// Design Notes // 设计说明 /// Due to the eventual consistency behaviour of s3, the semantics of pushing are slightly different when pushing to a 'proper' git repository. An attempt is made to prevent non-force pushes that do not include the current head as an ancestor (as proper git repos do), but eventual consistency means this is not guaranteed. Its possible for multiple heads to exist for the same branch, in which case the clients consider the newest head to be the truth. All heads for a branch can be seen using git ls-remote - the latest (newest) head the have the branch's name; older head will be shown using the naming scheme: <branch_name>__<sha>. An old head is retained until a new head is pushed that includes the old head as an ancestor, at which point the old head is deleted. This prevents any data loss, but puts the burden on the user to manually merge in old branches. // 由于 S3 的最终一致性机制，推送操作的语义与推送到“正规”Git 仓库略有不同。虽然 S3 会尝试阻止不包含当前分支头（head）作为祖先的非强制推送（正规 Git 仓库会这样做），但最终一致性机制意味着无法保证完全避免这种情况。同一个分支可能存在多个分支头，在这种情况下，客户端会将最新的分支头视为真实状态。可以使用 git ls-remote 命令查看某个分支的所有分支头——最新的分支头会显示分支名称；较旧的分支头则会使用以下命名方案： <branch_name>__<sha> 。旧的分支头会一直保留，直到推送一个新的分支头，并且该分支头包含旧的分支头作为祖先，此时旧的分支头才会被删除。这可以防止数据丢失，但同时也增加了用户手动合并旧分支的负担。 /// Each branch is stored (after being bundled with git bundle and encrypted with gpg) on s3 using the key s3://bucket/prefix/<ref_name>/<sha>.bundle. On average, a git push will incur two list, a put and a delete s3 operation. A git pull will incur a list and a get s3 operation. // 每个分支在用 git bundle 打包并加密后都会被存储。 使用键 s3://bucket/prefix/<ref_name>/<sha>.bundle 对 S3 进行 gpg 操作。平均而言，一次 git push 会产生两次 list 操作、一次 put 操作和一次 delete 操作。一次 git pull 会产生一次 list 操作和一次 get 操作。 /// Future improvements // 未来改进 /// - A better way to notify the user there are multiple heads on s3. // 更好的通知用户 S3 上有多个头的方法。 /// - - Show warning when attempting to push/fetch and there are multiple heads for a branch? // 当尝试推送/获取代码时，如果某个分支存在多个头部，是否显示警告？ /// - Allow disabling gpg with remote.<name>.gpg // 允许使用 remote.<name>.gpg 禁用 gpg /// - use gpg.program // 使用 gpg.program"
[cli.cargo/crates]: https://crates.io/crates/git-remote-s3 "(: cargo install -- git-remote-s3) (MIT) (530 SLoC) (21.8 KiB) Push and pull git repos to/from an s3 bucket, encrypted using gpg. // 使用 gpg 加密，将 git 仓库推送到 s3 存储桶或从 s3 存储桶拉取 git 仓库。 (src: gh:bgahagan/git-remote-s3.git)"

