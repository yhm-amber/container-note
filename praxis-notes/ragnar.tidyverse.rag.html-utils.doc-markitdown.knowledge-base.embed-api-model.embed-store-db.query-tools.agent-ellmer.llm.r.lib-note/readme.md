[src/gh]: https://github.com/tidyverse/ragnar.git "(MIT) (Languages: R 72.9%, CSS 22.5%, Python 2.1%, JavaScript 1.6%, Other 0.9%) RAG in R // R 中的 RAG /// ragnar is an R package that helps implement Retrieval-Augmented Generation (RAG) workflows. It focuses on providing a complete solution with sensible defaults, while still giving the knowledgeable user precise control over each step. We don’t believe that you can fully automate the creation of a good RAG system, so it’s important that ragnar is not a black box. ragnar is designed to be transparent. You can easily inspect outputs at intermediate steps to understand what’s happening. // ragnar 是一个 R 包，用于帮助实现检索增强生成（RAG）工作流程。它专注于提供一套完整的解决方案，并设置合理的默认值，同时仍然允许有经验的用户对每个步骤进行精确控制。我们不相信可以完全自动化良好 RAG 系统的创建，因此 ragnar 不是一个黑盒。 ragnar 的设计目标是透明的。您可以轻松检查中间步骤的输出，以了解正在发生什么。 /// (: pages <- ragnar::ragnar_find_links('https://r4ds.hadley.nz') ;: store <- here::here('r4ds.ragnar.duckdb') |> ragnar::ragnar_store_create(embed = \ (x) x |>   ragnar::embed_lm_studio(base_url = Sys.getenv('LMSTU_EMBEDDINGS_BASE_URL'), api_key = Sys.getenv('LMSTU_EMBEDDINGS_API_KEY'), model = Sys.getenv('LMSTU_EMBEDDINGS_MODEL'))) # specify db as store with embed model ;: pages |> purrr::map(\ (page) { 'ingesting: ' |> message(page); chunks <- ragnar::read_as_markdown(page) |> ragnar::markdown_chunk(); store |> ragnar::ragnar_store_insert(chunks) }) # save knowledges into store ;: ragnar::ragnar_store_build_index(store) # build index for store) (: store_ro <- here::here('r4ds.ragnar.duckdb') |> ragnar::ragnar_store_connect(read_only = TRUE) # using store with read-only mode ;: (relevant_chunks <- store_ro |> ragnar::ragnar_retrieve('How can I subset a dataframe with a logical vector?')) # Retrieving Chunks ;: chat <- ellmer::chat_vllm(...) # using store on ellmer chat - create a chat obj ;: chat$set_system_prompt('You are an expert R programmer and mentor. You are concise. Before responding, retrieve relevant material from the knowledge store. Quote or paraphrase passages, clearly marking your own words versus the source. Provide a working link for every source cited, as well as any additional relevant links. Do not answer unless you have retrieved and cited a source.') # sys-prompt demo ;: chat |> ragnar::ragnar_register_tool_retrieve(store_ro) # using store on ellmer chat - register (means give) store-query ability as ellmer tool to that chat obj ;: chat$chat('How can I subset a dataframe?') #| ◯ [tool call] rag_retrieve_from_store_001(text = 'How to subset a dataframe in R') #| ● #> ... # it will searching from knowledge base (i.e., the `store_ro`) before answer.)"
[package/cran]: https://cran.r-project.org/web/packages/ragnar/ "(Version: 	0.2.1) (Depends: 	R (≥ 4.3.0)) (Imports: 	blob, cli, commonmark, curl, DBI, dbplyr, dplyr, duckdb (≥ 1.3.1), glue, httr2, methods, reticulate (≥ 1.42.0), rlang (≥ 1.1.0), rvest, S7, stringi, tidyr, vctrs, withr, xml2) (Suggests: 	connectcreds, ellmer (≥ 0.3.0), gargle, knitr, lifecycle, pandoc, paws.common, rmarkdown, shiny, stringr, tibble, testthat (≥ 3.0.0)) (Published: 	2025-08-19) (DOI: 	10.32614/CRAN.package.ragnar) (Author: 	Tomasz Kalinowski [aut, cre], Daniel Falbel [aut], Posit Software, PBC ROR ID [cph, fnd]) (Maintainer: 	Tomasz Kalinowski <tomasz at posit.co>) (License: 	MIT + file LICENSE) (NeedsCompilation: 	yes) ragnar: Retrieval-Augmented Generation (RAG) Workflows // ragnar: 检索增强生成（RAG）工作流 /// Provides tools for implementing Retrieval-Augmented Generation (RAG) workflows with Large Language Models (LLM). Includes functions for document processing, text chunking, embedding generation, storage management, and content retrieval. Supports various document types and embedding providers ('Ollama', 'OpenAI'), with 'DuckDB' as the default storage backend. Integrates with the 'ellmer' package to equip chat objects with retrieval capabilities. Designed to offer both sensible defaults and customization options with transparent access to intermediate outputs. For a review of retrieval-augmented generation methods, see Gao et al. (2023) \"Retrieval-Augmented Generation for Large Language Models: A Survey\" <doi:10.48550/arXiv.2312.10997>. // 提供用于使用大型语言模型（LLM）实现检索增强生成（RAG）工作流的工具。包括用于文档处理、文本分块、嵌入生成、存储管理和内容检索的函数。支持多种文档类型和嵌入提供者（'Ollama'、'OpenAI'），默认存储后端为'DuckDB'。与'ellmer'包集成，为聊天对象配备检索功能。设计旨在提供合理的默认值和定制选项，并透明地访问中间输出。有关检索增强生成方法的综述，请参阅 Gao 等人（2023 年）的《大型语言模型的检索增强生成：一项调查》< doi:10.48550/arXiv.2312.10997>。 (src: gh:tidyverse/ragnar.git)"
[site/tidyverse.org]: https://ragnar.tidyverse.org/ "ragnar is an R package that helps implement Retrieval-Augmented Generation (RAG) workflows. It focuses on providing a complete solution with sensible defaults, while still giving the knowledgeable user precise control over each step. We don’t believe that you can fully automate the creation of a good RAG system, so it’s important that ragnar is not a black box. ragnar is designed to be transparent. You can easily inspect outputs at intermediate steps to understand what’s happening. // ragnar 是一个 R 包，用于帮助实现检索增强生成（RAG）工作流程。它专注于提供一套完整的解决方案，同时保留对每个步骤的精确控制。我们并不认为可以完全自动化一个良好 RAG 系统的创建，因此 ragnar 不是一个黑盒。 ragnar 的设计是透明的。您可以轻松检查中间步骤的输出，以了解正在发生什么。 /// ## Key Steps // 关键步骤 /// ### 1. Document Processing // 1. 文档处理 /// ragnar works with a wide variety of document types, using MarkItDown to convert content to Markdown. // ragnar 支持多种文档类型，使用 MarkItDown 将内容转换为 Markdown。 /// Key functions: // 关键功能： /// - read_as_markdown(): Convert a file or URL to markdown // read_as_markdown() : 将文件或 URL 转换为 markdown /// - ragnar_find_links(): Find all links in a webpage // ragnar_find_links() : 查找网页中的所有链接 /// ### 2. Text Chunking // 2. 文本分块 /// Next we divide each document into chunks. Ragnar defaults to a strategy that preserves some of the semantics of the document, but provides plenty of opportunities to tweak the approach. // 接下来我们将每个文档分割成块。Ragnar 默认采用一种保留文档部分语义的策略，但同时也提供了许多调整方法的机会。 /// Key functions: // 主要功能： /// - markdown_chunk(): Full-featured chunker that identifies semantic boundaries and intelligently chunks text. // markdown_chunk() : 全功能分块器，可识别语义边界并智能地分块文本。 /// ### 3. Context Augmentation (Optional) // 3. 上下文增强（可选） /// RAG applications benefit from augmenting text chunks with additional context, such as document headings and subheadings. ragnar makes it easy to keep track of headings and subheadings as part of chunking. // RAG 应用可以从添加额外上下文（如文档标题和副标题）来增强文本块中受益。 ragnar 可轻松地在分块过程中跟踪标题和副标题。 /// markdown_chunk() automatically associates each chunk with the headings that are in scope for that chunk. // markdown_chunk() 自动将每个片段与该片段范围内的标题相关联。 /// ### 4. Embedding // 4. 嵌入 /// ragnar can help compute embeddings for each chunk. The goal is for ragnar to provide access to embeddings from popular LLM providers. // ragnar 可以帮助为每个片段计算嵌入。目标是为 ragnar 提供对来自流行 LLM 供应方的嵌入的访问。 /// Key functions: // 关键功能： /// - embed_ollama() /// - embed_openai() /// - embed_bedrock() /// - embed_databricks() /// - embed_google_vertex() /// Note that calling the embedding function directly is typically not necessary. Instead, the embedding function is specified when a store is first created, and then automatically called when needed by ragnar_retrieve() and ragnar_store_insert(). // 请注意，通常无需直接调用嵌入函数。相反，嵌入函数在存储首次创建时指定，然后由 ragnar_retrieve() 和 ragnar_store_insert() 在需要时自动调用。 /// ### 5. Storage // 5. 存储 /// Processed data is stored in a format optimized for efficient searching, using duckdb by default. The API is designed to be extensible, allowing additional packages to implement support for different storage providers. // 处理后的数据以高效搜索优化的格式存储，默认使用 duckdb 。该 API 设计为可扩展，允许额外的包实现对不同存储提供者的支持。 /// Key functions: // 主要功能： /// - ragnar_store_create() /// - ragnar_store_connect() /// - ragnar_store_insert() /// ### 6. Retrieval // 6. 检索 /// Given a prompt, retrieve related chunks based on embedding distance or bm25 text search. // 给定一个提示，根据嵌入距离或 BM25 文本搜索检索相关片段。 /// Key functions: // 主要功能： /// - ragnar_retrieve(): high-level function that performs both vss and bm25 search and de-overlaps retrieved results. // ragnar_retrieve() : 高级功能，执行 vss 和 bm25 搜索并去重叠检索结果。 /// - ragnar_retrieve_vss(): Retrieve using vss DuckDB extension // ragnar_retrieve_vss() : 使用 vss DuckDB 扩展检索 /// - ragnar_retrieve_bm25(): Retrieve using full-text search DuckDB extension // ragnar_retrieve_bm25() : 使用 full-text search DuckDB extension 检索 /// - chunks_deoverlap(): Consolidates retrieved chunks that overlap. // chunks_deoverlap() : 合并重叠的检索块。 /// ### 7. Chat Augmentation // 7. 对话增强 /// ragnar can equip an ellmer::Chat object with a retrieve tool that enables an LLM to retrieve content from a store on-demand. // ragnar 可以给 ellmer::Chat 对象装备一个检索工具，使 LLM 能够按需从存储中检索内容。 /// - ragnar_register_tool_retrieve(chat, store)."
[knows_by]: https://github.com/tidyverse/ellmer.git "ellmer is one of a number of LLM-related packages created by Posit: /// ... /// - Need RAG? Take a look at ragnar."

